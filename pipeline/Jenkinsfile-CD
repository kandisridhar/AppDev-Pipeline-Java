@Library('shared-library') _
pipeline {
  agent any
  environment {
    azcon = credentials('azure-creds')
    nexuslogin = credentials('nexus-ID')
  }
   
   stages {   
    
    stage('Infra Provisioning') {
      steps {
        Infra()
      }
    }
    
    stage('FetchPublicIP') {
      steps {
        FetchPublicIP()
      }
    }
    stage('Download Artifact From Nexus') {
      steps {
        DownloadFromNexus(nexuslogin)
      }
      }
    stage('DeployToTomcat') {   
      steps{
        withCredentials([usernamePassword(credentialsId: 'vm-creds', passwordVariable: 'password', usernameVariable: 'username')]) {
        DeployToTomcat(username, password)
       }
       }
       }
    }
}
